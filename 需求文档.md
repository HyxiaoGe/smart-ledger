你的目标是：

> ✅ 快速实现一个可用的 **MVP 智能记账 Web 应用**，
>  ✅ 一站式用 **Next.js + Supabase + AI API** 完成，
>  ✅ 尽量减少复杂度（不拆前后端，不做登录系统，先跑起来）。

下面是我帮你整理的 **完整 MVP 需求文档**

------

# 🧾 智能记账应用（MVP 版本）需求文档

## 一、项目概述

**项目名称**：Smart Ledger（智能记账）
 **目标**：实现一个简洁、实用的记账网页应用，用户可手动输入日常支出与收入，自动生成统计图表，并通过 AI 提供分析建议。
 **特点**：

- 轻量化、可本地使用；
- 一站式：使用 Next.js 实现前后端；
- 数据持久化使用 Supabase；
- 集成 OpenAI / DeepSeek API，用于智能分析。

------

## 二、技术选型

| 模块     | 技术栈                       | 说明                         |
| -------- | ---------------------------- | ---------------------------- |
| 前端框架 | **Next.js (App Router)**     | 一体化全栈开发，支持 SSR/ISR |
| 样式/UI  | **Tailwind CSS + Shadcn/UI** | 快速构建现代化 UI            |
| 数据库   | **Supabase**                 | 提供 Postgres + API 接口     |
| ORM      | **Supabase JS SDK**          | 直接操作数据库               |
| 图表     | **Recharts**                 | 轻量、简单的统计可视化       |
| AI 分析  | **OpenAI/DeepSeek API **     | 提供消费分析与建议生成       |
| 部署     | **Vercel / 本地 Docker**     | 快速上线或本地运行           |

------

## 三、功能需求

### 1. 基础功能

#### （1）账单管理

- **添加账单**
  - 输入：金额、类别、备注、日期、类型（支出/收入）
  - 支持快捷类别选择
- **查看账单**
  - 按日期倒序展示账单列表
  - 显示总收入、总支出、余额
- **编辑/删除账单**
  - 支持修改或删除已有记录

#### （2）数据统计

- **月度支出趋势图**（折线图）
- **支出类别占比**（饼图）
- **收支对比图**（柱状图）
- 支持切换月份查看统计数据

------

### 2. AI 功能

#### （1）智能分析报告

- 点击“AI 分析”按钮后，应用会将当前月份的账单数据发送至 LLM；

- 模型输出分析文本，例如：

  > “你本月支出共 4800 元，其中餐饮占比 30%，娱乐占比 20%。相比上月增加 12%。建议控制外出用餐次数。”

#### （2）自然语言查询（可选）

- 用户输入问题，例如：

  > “我这个月花最多的是哪一类？”

- LLM 根据账单数据返回自然语言答案。

------

### 3. 非功能性需求

- 无需登录系统（使用本地或默认匿名用户）
- 简洁美观、响应速度快
- 可在桌面浏览器中直接使用
- MVP 阶段不考虑移动端适配

------

## 四、数据库设计（Supabase）

### 表：`transactions`

| 字段名     | 类型               | 说明                 |
| ---------- | ------------------ | -------------------- |
| id         | UUID (Primary Key) | 唯一标识             |
| type       | TEXT               | 'income' / 'expense' |
| category   | TEXT               | 消费类别             |
| amount     | NUMERIC            | 金额                 |
| note       | TEXT               | 备注                 |
| date       | DATE               | 交易日期             |
| created_at | TIMESTAMP          | 自动生成时间戳       |

------

## 五、页面设计与交互流程

### 1️⃣ 首页 `/`

- 显示汇总数据（本月支出、收入、余额）
- 展示图表区（支出趋势、类别占比）
- “AI 分析”按钮
- “添加账单”浮动按钮

### 2️⃣ 添加账单 `/add`

- 表单输入：金额、类型、类别、日期、备注
- 提交后写入 Supabase 并返回首页

### 3️⃣ 账单列表 `/records`

- 展示所有账单记录
- 支持按日期筛选
- 每条账单右侧提供编辑、删除操作

------

## 六、AI 分析接口设计

### Endpoint

```
POST /api/analyze
```

### 请求参数

```json
{
  "month": "2025-10",
  "transactions": [
    { "type": "expense", "category": "food", "amount": 36, "date": "2025-10-03" },
    { "type": "income", "category": "salary", "amount": 8000, "date": "2025-10-01" }
  ]
}
```

### 响应示例

```json
{
  "summary": "你本月总支出 4800 元，收入 8000 元，支出较上月增加 12%。娱乐支出较高，建议控制非必要开销。"
}
```

### 实现方式

在 `/app/api/analyze/route.ts` 中：

- 获取账单数据
- 构造 prompt
- 调用 OpenAI / DeepSeek API
- 返回结果文本

------

## 七、AI 提示词模板（Prompt）

```text
你是一名个人理财助手。根据用户提供的账单数据，输出本月消费总结与建议。
请包含以下内容：
1. 总收入、总支出及收支平衡；
2. 前三大支出类别；
3. 与上月相比的变化；
4. 简要建议。

输出简洁自然语言，不要返回表格或代码。
```

## 八、目录结构（Next.js 结构建议）

```
smart-ledger/
├─ app/
│  ├─ page.tsx              # 首页（统计 + 图表）
│  ├─ add/page.tsx          # 添加账单
│  ├─ records/page.tsx      # 账单列表
│  ├─ api/
│  │   └─ analyze/route.ts  # AI 分析接口
│  └─ components/
│       ├─ ChartSummary.tsx
│       ├─ TransactionForm.tsx
│       ├─ TransactionList.tsx
│       └─ SummaryCard.tsx
├─ lib/
│  ├─ supabaseClient.ts     # Supabase 初始化
│  └─ aiClient.ts           # OpenAI / Ollama 调用
├─ types/
│  └─ transaction.ts
├─ .env.local               # API Key 等配置
└─ package.json
```

------

## 🔟 环境变量示例（.env.local）

```bash
NEXT_PUBLIC_SUPABASE_URL=https://xxxx.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=xxxx
OPENAI_API_KEY=sk-xxxxxx
```

------

## ✅ MVP 完成标准

- 可以新增/查看/删除账单；
- 数据实时保存到 Supabase；
- 图表正常显示；
- 一键生成 AI 消费分析报告；
- UI 简洁美观；
- 可本地运行或部署到 Vercel。